import{c as t,a as e,b as n,g as o}from"./p-c2089e63.js";class r{constructor(){this.m=new Map}reset(t){this.m=new Map(Object.entries(t))}get(t,e){const n=this.m.get(t);return void 0!==n?n:e}getBoolean(t,e=!1){const n=this.m.get(t);return void 0===n?e:"string"==typeof n?"true"===n:!!n}getNumber(t,e){const n=parseFloat(this.m.get(t));return isNaN(n)?void 0!==e?e:NaN:n}set(t,e){this.m.set(t,e)}}const a=new r;let s=0;const i=new WeakMap,c=t=>({create:e=>v(t,e),dismiss:(e,n,o)=>g(document,e,n,t,o),getTop:async()=>N(document,t)}),d=c("bkkr-alert"),u=c("bkkr-drawer"),k=c("bkkr-loading"),l=c("bkkr-modal"),b=c("bkkr-popover"),p=c("bkkr-toast"),m=t=>{"undefined"!=typeof document&&x(document);const e=s++;t.overlayIndex=e,t.hasAttribute("id")||(t.id=`bkkr-overlay-${e}`)},v=(e,n)=>"undefined"!=typeof customElements?customElements.whenDefined(e).then((()=>{const o=document.createElement(e);return o.classList.add("overlay-hidden"),Object.assign(o,Object.assign({},n)),B(document).appendChild(o),new Promise((e=>t(o,e)))})):Promise.resolve(),y='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]):not([tabindex^="-"]), textarea:not([tabindex^="-"]), button:not([tabindex^="-"]), select:not([tabindex^="-"]), .state-focusable:not([tabindex^="-"])',f="input:not([type=hidden]), textarea, button, select",h=(t,e)=>{let n=t.querySelector(y);const o=n&&n.shadowRoot;o&&(n=o.querySelector(f)||n),n?n.focus():e.focus()},w=(t,e)=>{const n=Array.from(t.querySelectorAll(y));let o=n.length>0?n[n.length-1]:null;const r=o&&o.shadowRoot;r&&(o=r.querySelector(f)||o),o?o.focus():e.focus()},x=t=>{0===s&&(s=1,t.addEventListener("focus",(e=>((t,e)=>{const n=N(e),r=t.target;n&&r&&(n.shadowRoot?(()=>{if(n.contains(r))n.lastFocus=r;else{const t=n.lastFocus;h(n,n),t===e.activeElement&&w(n,n),n.lastFocus=e.activeElement}})():(()=>{if(n===r)n.lastFocus=void 0;else{const t=o(n);if(!t.contains(r))return;const a=t.querySelector(".bkkr-overlay-wrapper");if(!a)return;if(a.contains(r))n.lastFocus=r;else{const t=n.lastFocus;h(a,n),t===e.activeElement&&w(a,n),n.lastFocus=e.activeElement}}})())})(e,t)),!0),t.addEventListener("keyup",(e=>{if("Escape"===e.key){const e=N(t);e&&e.backdropDismiss&&e.dismiss(void 0,F)}})))},g=(t,e,n,o,r)=>{const a=N(t,o,r);return a?a.dismiss(e,n):Promise.reject("overlay does not exist")},N=(t,e,n)=>{const o=((t,e)=>(void 0===e&&(e="bkkr-alert,bkkr-drawer,bkkr-loading,bkkr-modal,bkkr-popover,bkkr-toast"),Array.from(t.querySelectorAll(e)).filter((t=>t.overlayIndex>0))))(t,e);return void 0===n?o[o.length-1]:o.find((t=>t.id===n))},j=(t=!1)=>{const e=B(document).querySelector("bkkr-router-outlet, bkkr-nav, #bkkr-view-container-root");e&&(t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden"))},O=async(t,e,n,o)=>{var r,s;if(t.presented)return;j(!0),t.presented=!0,t.willPresent.emit(),null===(r=t.willPresentShorthand)||void 0===r||r.emit();const i=t.enterAnimation?t.enterAnimation:a.get(e,n);await E(t,i,t.el,o)&&(t.didPresent.emit(),null===(s=t.didPresentShorthand)||void 0===s||s.emit()),"BKKR-TOAST"!==t.el.tagName&&P(t.el),t.keyboardClose&&t.el.focus()},P=async t=>{let e=document.activeElement;if(!e)return;const n=e&&e.shadowRoot;n&&(e=n.querySelector(f)||e),await t.onDidDismiss(),e.focus()},A=async(t,e,n,o,r,s)=>{var c,d;if(!t.presented)return!1;j(!1),t.presented=!1;try{t.el.style.setProperty("pointer-events","none"),t.willDismiss.emit({data:e,role:n}),null===(c=t.willDismissShorthand)||void 0===c||c.emit({data:e,role:n});const u=t.leaveAnimation?t.leaveAnimation:a.get(o,r);"gesture"!==n&&await E(t,u,t.el,s),t.didDismiss.emit({data:e,role:n}),null===(d=t.didDismissShorthand)||void 0===d||d.emit({data:e,role:n}),i.delete(t),t.el.classList.add("overlay-hidden")}catch(t){console.error(t)}return t.el.remove(),!0},B=t=>t.querySelector("bkkr-root")||t.body,E=async(t,e,n,o)=>{n.classList.remove("overlay-hidden");const r=e(t.el,o);t.animated&&a.getBoolean("animated",!0)||r.duration(0),t.keyboardClose&&r.beforeAddWrite((()=>{const t=n.ownerDocument.activeElement;t&&t.matches("input,bkkr-input, bkkr-datepicker, bkkr-textarea")&&t.blur()}));const s=i.get(t)||[];return i.set(t,[...s,r]),await r.play(),!0},M=(t,e)=>{let n;const o=new Promise((t=>n=t));return T(t,e,(t=>{n(t.detail)})),o},T=(t,o,r)=>{const a=e=>{n(t,o,a),r(e)};e(t,o,a)},K=t=>"cancel"===t||t===F,F="backdrop";export{F as B,d as a,m as b,O as c,u as d,A as e,M as f,i as g,h,K as i,k as l,l as m,b as p,p as t}