import{a as t,b as e,g as n}from"./p-5527b9e6.js";let o=0;const a=new WeakMap,r=t=>({create:e=>l(t,e),dismiss:(e,n,o)=>f(document,e,n,t,o),getTop:async()=>x(document,t)}),s=r("bkkr-alert"),c=r("bkkr-drawer"),i=r("bkkr-loading"),d=r("bkkr-modal"),u=r("bkkr-popover"),k=r("bkkr-toast"),b=t=>{"undefined"!=typeof document&&y(document);const e=o++;t.overlayIndex=e,t.hasAttribute("id")||(t.id="bkkr-overlay-"+e)},l=(t,e)=>"undefined"!=typeof customElements?customElements.whenDefined(t).then((()=>{const n=document.createElement(t);return n.classList.add("overlay-hidden"),Object.assign(n,e),h(document).appendChild(n),n.componentOnReady()})):Promise.resolve(),p='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]):not([tabindex^="-"]), textarea:not([tabindex^="-"]), button:not([tabindex^="-"]), select:not([tabindex^="-"]), .bkkr-focusable:not([tabindex^="-"])',m="input:not([type=hidden]), textarea, button, select",y=t=>{0===o&&(o=1,t.addEventListener("focus",(e=>((t,e)=>{const o=x(e),a=t.target;if(o&&a)if(o===a)o.lastFocus=void 0;else{const t=n(o);if(!t.contains(a))return;const r=t.querySelector(".bkkr-overlay-wrapper");if(!r)return;if(r.contains(a))o.lastFocus=a;else{const t=o.lastFocus;((t,e)=>{let n=t.querySelector(p);const o=n&&n.shadowRoot;o&&(n=o.querySelector(m)||n),n?n.focus():e.focus()})(r,o),t===e.activeElement&&((t,e)=>{const n=Array.from(t.querySelectorAll(p));let o=n.length>0?n[n.length-1]:null;const a=o&&o.shadowRoot;a&&(o=a.querySelector(m)||o),o?o.focus():e.focus()})(r,o),o.lastFocus=e.activeElement}}})(e,t)),!0),t.addEventListener("keyup",(e=>{if("Escape"===e.key){const e=x(t);e&&e.backdropDismiss&&e.dismiss(void 0,j)}})))},f=(t,e,n,o,a)=>{const r=x(t,o,a);return r?r.dismiss(e,n):Promise.reject("overlay does not exist")},x=(t,e,n)=>{const o=((t,e)=>(void 0===e&&(e="bkkr-modal,bkkr-toast"),Array.from(t.querySelectorAll(e)).filter((t=>t.overlayIndex>0))))(t,e);return void 0===n?o[o.length-1]:o.find((t=>t.id===n))},v=async(t,e,n)=>{if(t.presented)return;t.presented=!0,t.willPresent.emit();const o=t.enterAnimation?t.enterAnimation:e;await A(t,o,t.el,n)&&t.didPresent.emit(),"BKKR-TOAST"!==t.el.tagName&&w(t.el),t.keyboardClose&&t.el.focus()},w=async t=>{let e=document.activeElement;if(!e)return;const n=e&&e.shadowRoot;n&&(e=n.querySelector(m)||e),await t.onDidDismiss(),e.focus()},g=async(t,e,n,o,r)=>{if(!t.presented)return!1;t.presented=!1;try{t.el.style.setProperty("pointer-events","none"),t.willDismiss.emit({data:e,role:n});const s=t.leaveAnimation?t.leaveAnimation:o;"gesture"!==n&&await A(t,s,t.el,r),t.didDismiss.emit({data:e,role:n}),a.delete(t)}catch(t){console.error(t)}return t.el.remove(),!0},h=t=>t.querySelector("bkkr-app")||t.body,A=async(t,e,n,o)=>{n.classList.remove("overlay-hidden");const r=e(n.shadowRoot||t.el,o);t.animated||r.duration(0),t.keyboardClose&&r.beforeAddWrite((()=>{const t=n.ownerDocument.activeElement;t&&t.matches("input, bkkr-input, bkkr-textarea")&&t.blur()}));const s=a.get(t)||[];return a.set(t,[...s,r]),await r.play(),!0},E=(t,e)=>{let n;const o=new Promise((t=>n=t));return P(t,e,(t=>{n(t.detail)})),o},P=(n,o,a)=>{const r=t=>{e(n,o,r),a(t)};t(n,o,r)},T=t=>"cancel"===t||t===j,j="backdrop";export{j as B,s as a,b,v as c,c as d,g as e,E as f,a as g,T as i,i as l,d as m,u as p,k as t}