import{r as t,e as s,c as e,h as i,H as o,g as n}from"./p-8dbe4215.js";import"./p-fcb88322.js";import{c as r}from"./p-0e6599a5.js";import{s as a,h}from"./p-09b2e663.js";const l=class{constructor(e){t(this,e),this.bkkrChange=s(this,"bkkrChange",7),this.bkkrSelect=s(this,"bkkrSelect",7),this.bkkrStyle=s(this,"bkkrStyle",7),this.didInit=!1,this.activated=!1,this.disabled=!1,this.scrollable=!1,this.swipeGesture=!0,this.onClick=t=>{const s=t.target,e=this.checked;"BKKR-SEGMENT"!==s.tagName&&(this.value=s.value,!this.scrollable&&this.swipeGesture||(e?this.checkButton(e,s):this.setCheckedClasses()),this.checked=s)}}colorChanged(t,s){(void 0===s&&void 0!==t||void 0!==s&&void 0===t)&&this.emitStyle()}swipeGestureChanged(){this.gestureChanged()}valueChanged(t,s){this.bkkrSelect.emit({value:t}),(""!==s||this.didInit)&&(this.activated?this.valueAfterGesture=t:this.bkkrChange.emit({value:t}))}disabledChanged(){this.gestureChanged();const t=this.getButtons();for(const s of t)s.disabled=this.disabled}gestureChanged(){this.gesture&&this.gesture.enable(!this.scrollable&&!this.disabled&&this.swipeGesture)}connectedCallback(){this.emitStyle()}componentWillLoad(){this.emitStyle()}async componentDidLoad(){this.setCheckedClasses(),this.gesture=r({el:this.el,gestureName:"segment",gesturePriority:100,threshold:0,passive:!1,onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.gestureChanged(),this.disabled&&this.disabledChanged(),this.didInit=!0}onStart(t){this.activate(t)}onMove(t){this.setNextIndex(t)}onEnd(t){this.setActivated(!1),t.event.stopImmediatePropagation();const s=this.valueAfterGesture;void 0!==s&&(this.bkkrChange.emit({value:s}),this.valueAfterGesture=void 0)}getButtons(){return Array.from(this.el.querySelectorAll("bkkr-segment-button"))}setActivated(t){this.getButtons().forEach((s=>{t?s.classList.add("segment-button-activated"):s.classList.remove("segment-button-activated")})),this.activated=t}activate(t){const s=t.event.target,e=this.getButtons().find((t=>t.value===this.value));"BKKR-SEGMENT-BUTTON"===s.tagName&&(e||(this.value=s.value,this.setCheckedClasses()),this.value===s.value&&this.setActivated(!0))}getIndicator(t){return(t.shadowRoot||t).querySelector(".segment-button-indicator")}checkButton(t,s){const i=this.getIndicator(t),o=this.getIndicator(s);if(null===i||null===o)return;const n=i.getBoundingClientRect(),r=o.getBoundingClientRect(),a=`translate3d(${n.left-r.left}px, 0, 0) scaleX(${n.width/r.width})`;e((()=>{o.classList.remove("segment-button-indicator-animated"),o.style.setProperty("transform",a),o.getBoundingClientRect(),o.classList.add("segment-button-indicator-animated"),o.style.setProperty("transform","")})),this.value=s.value,this.setCheckedClasses()}setCheckedClasses(){const t=this.getButtons(),s=t.findIndex((t=>t.value===this.value))+1;this.checked=t.find((t=>t.value===this.value));for(const s of t)s.classList.remove("segment-button-after-checked");s<t.length&&t[s].classList.add("segment-button-after-checked")}setNextIndex(t,s=!1){const e="rtl"===document.dir,i=this.activated,o=this.getButtons(),n=o.findIndex((t=>t.value===this.value)),r=o[n];let a,h;if(-1===n)return;const l=r.getBoundingClientRect(),c=l.left,d=l.width,g=t.currentX,u=document.elementFromPoint(g,l.top+l.height/2);if(i&&!s){if(e?g>c+d:g<c){const t=n-1;t>=0&&(h=t)}else if((e?g<c:g>c+d)&&i&&!s){const t=n+1;t<o.length&&(h=t)}void 0===h||o[h].disabled||(a=o[h])}if(!i&&s&&(a=u),null!=a){if("BKKR-SEGMENT"===a.tagName)return!1;r!==a&&this.checkButton(r,a)}return!0}emitStyle(){this.bkkrStyle.emit({segment:!0})}render(){return i(o,{onClick:this.onClick,class:a(this.color,{"in-toolbar":h("bkkr-toolbar",this.el),"in-toolbar-color":h("bkkr-toolbar[color]",this.el),"segment-activated":this.activated,"segment-disabled":this.disabled,"segment-scrollable":this.scrollable})},i("slot",null))}get el(){return n(this)}static get watchers(){return{color:["colorChanged"],swipeGesture:["swipeGestureChanged"],value:["valueChanged"],disabled:["disabledChanged"]}}};l.style=":host{--background:rgba(var(--bkkr-text-color-rgb, 0, 0, 0), 0.065);border-radius:8px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;width:100%;background:var(--background);text-align:center;contain:paint;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0}:host(.segment-scrollable){-ms-flex-pack:start;justify-content:start;width:auto;overflow-x:auto}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host(.segment-color){background:var(--color-base, 0.065)}:host(.in-toolbar){margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;width:auto}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-toolbar){margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}:host(.in-toolbar:not(.segment-color)){background:var(--toolbar-segment-background, var(--background))}:host(.in-toolbar-color:not(.segment-color)){background:var(--color-contrast, 0.11)}";export{l as bkkr_segment}