/*!
 * (C) BKKR Framework https://bkkr-team.github.io/bkkr-docs/ - MIT License
 */
import{r as t,c as s,a as e,h as i,H as r,g as a}from"./p-fef964f0.js";import{i as n}from"./p-3f411146.js";import{s as o,h}from"./p-18201c80.js";let c=class{constructor(e){t(this,e),this.bkkrChange=s(this,"bkkrChange",7),this.bkkrSelect=s(this,"bkkrSelect",7),this.bkkrStyle=s(this,"bkkrStyle",7),this.didInit=!1,this.activated=!1,this.disabled=!1,this.scrollable=!1,this.swipeGesture=!0,this.selectOnFocus=!1,this.onClick=t=>{const s=t.target,e=this.checked;"BKKR-SEGMENT"!==s.tagName&&(this.value=s.value,!this.scrollable&&this.swipeGesture||(e?this.checkButton(e,s):this.setCheckedClasses()),this.checked=s)},this.getSegmentButton=t=>{const s=this.getButtons().filter((t=>!t.disabled)),e=s.findIndex((t=>t===document.activeElement));switch(t){case"first":return s[0];case"last":return s[s.length-1];case"next":return s[e+1]||s[0];case"previous":return s[e-1]||s[s.length-1];default:return null}}}colorChanged(t,s){(void 0===s&&void 0!==t||void 0!==s&&void 0===t)&&this.emitStyle()}swipeGestureChanged(){this.gestureChanged()}valueChanged(t,s){this.bkkrSelect.emit({value:t}),(""!==s||this.didInit)&&(this.activated?this.valueAfterGesture=t:this.bkkrChange.emit({value:t}))}disabledChanged(){this.gestureChanged();const t=this.getButtons();for(const s of t)s.disabled=this.disabled}gestureChanged(){this.gesture&&this.gesture.enable(!this.scrollable&&!this.disabled&&this.swipeGesture)}connectedCallback(){this.emitStyle()}componentWillLoad(){this.emitStyle()}async componentDidLoad(){this.setCheckedClasses(),this.ensureFocusable(),this.gesture=(await __sc_import_bkkr("./p-b4206503.js")).createGesture({el:this.el,gestureName:"segment",gesturePriority:100,threshold:0,passive:!1,onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.gestureChanged(),this.disabled&&this.disabledChanged(),this.didInit=!0}onStart(t){this.activate(t)}onMove(t){this.setNextIndex(t)}onEnd(t){this.setActivated(!1),this.setNextIndex(t,!0),t.event.stopImmediatePropagation();const s=this.valueAfterGesture;void 0!==s&&(this.bkkrChange.emit({value:s}),this.valueAfterGesture=void 0)}getButtons(){return Array.from(this.el.querySelectorAll("bkkr-segment-button"))}setActivated(t){this.getButtons().forEach((s=>{t?s.classList.add("segment-button-activated"):s.classList.remove("segment-button-activated")})),this.activated=t}activate(t){const s=t.event.target,e=this.getButtons().find((t=>t.value===this.value));"BKKR-SEGMENT-BUTTON"===s.tagName&&(e||(this.value=s.value,this.setCheckedClasses()),this.value===s.value&&this.setActivated(!0))}getIndicator(t){return(t.shadowRoot||t).querySelector(".segment-button-indicator")}checkButton(t,s){const i=this.getIndicator(t),r=this.getIndicator(s);if(null===i||null===r)return;const a=i.getBoundingClientRect(),n=r.getBoundingClientRect(),o=`translate3d(${a.left-n.left}px, 0, 0) scaleX(${a.width/n.width})`;e((()=>{r.classList.remove("segment-button-indicator-animated"),r.style.setProperty("transform",o),r.getBoundingClientRect(),r.classList.add("segment-button-indicator-animated"),r.style.setProperty("transform","")})),this.value=s.value,this.setCheckedClasses()}setCheckedClasses(){const t=this.getButtons(),s=t.findIndex((t=>t.value===this.value))+1;this.checked=t.find((t=>t.value===this.value));for(const s of t)s.classList.remove("segment-button-after-checked");s<t.length&&t[s].classList.add("segment-button-after-checked")}setNextIndex(t,s=!1){const e=n(this.el),i=this.activated,r=this.getButtons(),a=r.findIndex((t=>t.value===this.value)),o=r[a];let h,c;if(-1===a)return;const l=o.getBoundingClientRect(),g=l.left,b=l.width,d=t.currentX,u=document.elementFromPoint(d,l.top+l.height/2);if(i&&!s){if(e?d>g+b:d<g){const t=a-1;t>=0&&(c=t)}else if((e?d<g:d>g+b)&&i&&!s){const t=a+1;t<r.length&&(c=t)}void 0===c||r[c].disabled||(h=r[c])}if(!i&&s&&(h=u),null!=h){if("BKKR-SEGMENT"===h.tagName)return!1;o!==h&&this.checkButton(o,h)}return!0}emitStyle(){this.bkkrStyle.emit({segment:!0})}onKeyDown(t){const s=n(this.el);let e,i=this.selectOnFocus;switch(t.key){case"ArrowRight":t.preventDefault(),e=this.getSegmentButton(s?"previous":"next");break;case"ArrowLeft":t.preventDefault(),e=this.getSegmentButton(s?"next":"previous");break;case"Home":t.preventDefault(),e=this.getSegmentButton("first");break;case"End":t.preventDefault(),e=this.getSegmentButton("last");break;case" ":case"Enter":t.preventDefault(),e=document.activeElement,i=!0}e&&(i&&this.checkButton(this.checked||e,e),e.focus())}ensureFocusable(){var t;void 0===this.value&&(null===(t=this.getButtons()[0])||void 0===t||t.setAttribute("tabindex","0"))}render(){return i(r,{role:"tablist",onClick:this.onClick,class:o(this.color,{"in-toolbar":h("bkkr-toolbar",this.el),"in-toolbar-color":h("bkkr-toolbar[color]",this.el),"segment-activated":this.activated,"segment-disabled":this.disabled,"segment-scrollable":this.scrollable})},i("slot",null))}get el(){return a(this)}static get watchers(){return{color:["colorChanged"],swipeGesture:["swipeGestureChanged"],value:["valueChanged"],disabled:["disabledChanged"]}}};c.style=":host{--background:rgba(var(--bkkr-text-color-rgb, 0, 0, 0), 0.04);--border-radius:44px;border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:var(--bkkr-spacer, 16px);margin-right:var(--bkkr-spacer, 16px);margin-top:0;margin-bottom:0;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;background:var(--background);font-size:inherit;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:var(--bkkr-spacer, 16px);margin-inline-start:var(--bkkr-spacer, 16px);-webkit-margin-end:var(--bkkr-spacer, 16px);margin-inline-end:var(--bkkr-spacer, 16px)}}:host(.segment-scrollable){-ms-flex-pack:start;justify-content:start;width:auto;overflow-x:auto}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host(.segment-color){background:var(--color-base, 0.04)}:host(.in-toolbar){margin-left:calc(var(--bkkr-spacer, 16px) - 4px);margin-right:calc(var(--bkkr-spacer, 16px) - 4px);margin-top:0;margin-bottom:0;width:auto}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-toolbar){margin-left:unset;margin-right:unset;-webkit-margin-start:calc(var(--bkkr-spacer, 16px) - 4px);margin-inline-start:calc(var(--bkkr-spacer, 16px) - 4px);-webkit-margin-end:calc(var(--bkkr-spacer, 16px) - 4px);margin-inline-end:calc(var(--bkkr-spacer, 16px) - 4px)}}:host(.in-toolbar:not(.segment-color)){background:var(--toolbar-segment-background, var(--background))}:host(.in-toolbar-color:not(.segment-color)){background:var(--color-contrast, 0.11)}";export{c as bkkr_segment}